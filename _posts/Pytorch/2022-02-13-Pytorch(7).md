---
title : "Pytorch MNIST 모델"
category :
    - pytorch
tag :
    - pytorch
    - deep-learning
    - machine-learning
toc : true
toc_sticky: true
comments: true
---
MNIST 모델에 대하여 알아보자 


# module import

우선 필요한 모듈들을 import 해준다.

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim
from torch.utils.data import Dataset, DataLoader

import torchvision
import torchvision.datasets
import torchvision.transforms as transforms

import numpy as np
import matplotlib.pyplot as plt
plt.style.use('seaborn-white')
```

# 전처리 설정
- `transform.Compose` :  우리가 원하는 대로 데이터를 핸들링 가능
  
`trochvision.transforms` 모듈을 이용시 `transform` 을 구현할 수 있다. 

파라미터로는 일반적으로 텐서로 형식을 바꿔준 뒤 

Normalize를 통해 (mean ,std)를 설정해준다. 

```python
transform = transforms.Compose([transforms.ToTensor(), # PIL 형식을 Tensor로 바꿔서 사용 
                                transforms.Normalize((0.5, ), (0.5))]) # mean과 std를 0.5씩 
```

# 데이터 로드 및 데이터 확인

```python
# torchvision에서 제공하는 dataset에 MNIST가 있음. 우리는 그것을 사용할 예정
trainset = torchvision.datasets.MNIST(root='./data',
                                      train = True,
                                      download = True,
                                      transform=transform)

testset = torchvision.datasets.MNIST(root='./data',
                                      train = False,
                                      download = True,
                                      transform=transform)
```


```python
# torch.uitls에서 제공하는 dataLoader를 사용하여 우리가 사용할 MNIST 데이터셋을 불러온다.
# 앞서 다운받은 trainset과 testset을 불러옴.
train_loader = DataLoader(trainset,
                          batch_size=128,
                          shuffle=True,
                          num_workers=2)

# testset은 shuffle을 하지 않는다.
test_loader = DataLoader(testset,
                          batch_size=128,
                          shuffle=False,
                          num_workers=2)
```

```python
# train_loader를 image와 label로 분류
image, label = next(iter(train_loader)) 

# 나눈 image, label의 shape을 확인
image.shape, label.shape
# (torch.Size([128, 1, 28, 28]), torch.Size([128]))
```

batchsize를 128로 가져왔기 때문에 맨앞이 128인것을 확인 가능하다.

grayscale은 1, 채널수 28, 입력크기 28 

