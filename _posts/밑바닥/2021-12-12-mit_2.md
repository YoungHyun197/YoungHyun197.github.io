---
title : "$2. 퍼셉트론(Perceptron)"
category :
    - mit
tag :
    - depp_learning
    - machine_learning
    - computer vision
toc : true
toc_sticky: true
comments: true
---
퍼셉트론에 대하여 알아보자.





# 2.1 퍼셉트론이란?

퍼셉트론은 신경망(딥러닝)의 기원이 되는 알고리즘이다.

- 퍼셉트론은 다수의 신호를 입력받아 하나의 신호를 출력한다. 
- (1은 신호가 흐름, 0은 신호가 흐르지않음)



![](/assets/image/2022-02-16-19-26-37.png)

x1, x2는 입력신호, y는 출력신호, w1과 w2는 가중치를 뜻한다.

그림의 원을 뉴런 혹은 노드라고 부른다.

입력신호가 뉴런에 보내질 때는 각각 고유한 가중치가 곱해진다. (w1x1,w2x2)

신호의 총합이 정해진 한계를 넘어설 때만 1이 출력되고, 

이를 뉴런을 활성화 한다고 말한다.

정해진 한계를 임계값이라고 하며 기호 θ로 나타낸다.


위 내용을 수식으로 나타내면 다음과 같다.

y = { 0 (w1x1 + w2x2 <= θ)

{ 1 (w1x1 + w2x2 > θ )


가중치 θ 는 전류에서 저항에 해당한다. 

저항은 전류의 흐름을 억제하는 매개변수이다.

전류에서는 저항이 작을수론 큰 전류가 흐르지만,

퍼셉트론의 가중치 θ는 값이 클수록 강한 신호를 출력한다.


# 2.2 단순한 논리회로


## 2.2.1 AND 게이트



![](/assets/image/2022-02-16-19-27-18.png)

AND게이트는 입력이 모두 1일때만 1을 출력하고 그 외에는 0을 출력한다.

이것을 퍼셉트론으로 어떻게 표현할 수 있을까?

입력을 x1, x2라하 할때, 우리는 위 진리표 대로 동작할 수 있도록 w1, w2 ,θ를 구하면 된다.

이러한 매개변수 조합은 무한히 많다. 몇가지 예를 들어보자.

(w1, w2, θ) = (0.5, 0.5, 0.7), (0.6, .0.6, 0.7), (1.0, 1.0, 1.0) 등


이렇게 설정하면 우리는 앞서 위에서 작성했던 식을 만족하는 매개변수 식을 찾은것이며,

x1과 x2가 모두 1일때만 1이출력된다. 이는 AND게이트와 동작이 일치한다.

y = { 0 (w1x1 + w2x2 <= θ)

{ 1 (w1x1 + w2x2 > θ )



## 2.2.2 NAND 게이트와 OR 게이트

- NAND 게이트는 AND게이트의 출력을 뒤집은 not AND 게이트이다.



![](/assets/image/2022-02-16-19-27-36.png)

즉 x1, x2가 모두1인 경우만 0을 출력하고 그 외에는 출력값이 1이 나오는것이다.

NAND게이트를 만족하는 w1, w2, θ를 찾아보자. (이 부분은 직접 찾아보는것을 권장한다.)

(w1, w2, θ) = (-0.4, -0.4, -0.6)


무수히 많은 조합이 있지만, AND 게이트의 매개변수 값을 그대로 뒤집으면 쉽게 구할수 있다.

(w1, w2, θ) = (-0.5, -0.5, -0.7), (-0.6, -0.6, -0.7), (-1.0, -1.0, -1.0) 등


같은 방식으로 OR 게이트의 매개변수도 구해보자.

OR 게이트는 x1, x2 중 하나만 1이 나오면 1이 출력되는 게이트이다.




![](/assets/image/2022-02-16-19-27-53.png)

(w1, w2, θ) = (0.3, 0.3, 0.1), (0.3, 0.3, 0.2), (1, 1, 0.5) 등


위와 같이 퍼셉트론으로 AND, NAND, OR 논리 회로를 표현할 수 있다.

퍼셉트론의 구조는 AND, NAND, OR 게이트 모두 똑같다. 다만 매개변수 값만 다를 뿐이다.



# 2.3 퍼셉트론 구현하기

위에서 배운 내용을 파이썬 코드로 구현해보자.

즉각적인 피드백을 위해 jupyter notebook 환경에서 실습해보는 것을 권장한다.


## 2.3.1 간단한 구현



![](/assets/image/2022-02-16-19-28-45.png)

``` python
def AND(x1, x2):
    w1, w2, theta = 0.5, 0.5, 0.7
    tmp = x1*w1 + x2*w2
    if tmp <= theta:
        return 0
    elif tmp > theta:
        return 1

AND(0, 0)
AND(0, 1)
AND(1, 0)
AND(1, 1)
```
2.3.2 가중치와 편향 도입


앞서 배운 식에서는 우변에 θ가 나타난다. 일반적으로 우변에 0이나오는 식이 깔끔하고, 직관적으로

이해하기 쉽기 때문에 식을 변형해보자.


y = { 0 (w1x1 + w2x2 - θ <= 0 )

{ 1 (w1x1 + w2x2 - θ > 0 )


여기서 보다 직관성을 뛰게 하기 위해 - θ를 b로 치환하자.

y = { 0 (b + w1x1 + w2x2 <= 0 )

{ 1 (b + w1x1 + w2x2 > 0 )


일반적으로 위와 같은 식을 더 많이 사용하고 여기서 b는 편향(bias)라고 부르고,

w1과 w2는 전과 마찬가지로 가중치라고 부른다.


위 식을 해석해보자면 퍼셉트론은 (입력신호에 가중치를 곱한 값) + (편향) 이 0을 넘으면 1을 출력

0보다 작거나 같으면 0을 출력한다.


파이썬에서 위 코드를 다시 작성해보자.


![](/assets/image/2022-02-16-19-29-43.png)

``` python
import numpy as np
x = np.array([0,1])
w = np.array([0.5, 0.5])
b = -0.7
w*x

np.sum(w*x)
np.sum(w*x) + b

```

## 2.3.3 가중치와 편향 구하기


```python
def AND(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.5, 0.5])
    b = -0.7
    tmp = np.sum(w*x) + b
    if(tmp <= 0):
        return 0
    elif (tmp > 0):
        return 1
```


여기서 주의해야 할 것은 편향과 가중치의 역할을 정확히 구분할 수 있어야 한다는 것이다.

w1과 w2는 각 입력 신호가 결과에 주는 영향력을 조절하는 매개변수이고,

편향은 뉴런이 얼마나 쉽게 활성화하느냐를 조정하는 매개변수이다.


같은 방식으로 NAND와 OR게이트를 구현해보자 (이 부분은 반드시 스스로 구현해보자)


```python
def NAND(x1, x2):
    x = np.array([x1, x2])
    w = np.array([-0.5, -0.5])
    b = 0.7
    tmp = np.sum(w*x) + b
    if (tmp <=0):
        return 0
    else:
        return 1

def OR(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.2, 0.2])
    b = -0.1
    tmp = np.sum(w*x) + b
    if (tmp <=0):
        return 0
    else:
        return 1
```

# 2.4 퍼셉트론의 한계


## 2.4.1 XOR 게이트

XOR게이트는 x1과 x2중 하나만 1일때 1을 출력하는 게이트이다. (배타적 논리합)


XOR 게이트는 앞서 배운 퍼셉트론으로는 구현이 불가하다.

그 이유는 시각화해보면 쉽게 파악할 수 있다.

![](/assets/image/2022-02-16-19-31-26.png)



동그라미와 세모를 구분해야하는데 여태까지 배운 퍼셉트론은 1차식

(즉, 직선식) 이기 때문에 이것을 구분하는데 한계를 가진다.


## 2.4.2 선형과 비선형

XOR게이트 문제를 해결하기 위해서는 직선이라는 제약을 없애야 한다.

비선형 영역으로 나누게되면 충분히 표현가능해진다.


# 2.5 다층 퍼셉트론

퍼셉트론에 층을쌓아 다층퍼셉트론을 만든다면 XOR 문제를 해결할 수 있다.


## 2.5.1 기존 게이트 조합하기

XOR 게이트를 만들기 위해서 기존에 배운 AND, NAND, OR 게이트를 조합하면 된다.

이것은 한번 스스로 고민해보자.

![](/assets/image/2022-02-16-19-32-01.png)

NAND의 출력을 s1, OR의 출력을 s2 라하자.


## 2.5.2 XOR 게이트 구현

그러면 다음과 같이 손 쉽게 XOR 게이트를 구현할 수 있다.



``` pyhton
def XOR(x1, x2):
    s1 = NAND(x1, x2)
    s2 = OR(x1, x2)
    return AND(s1,s2)
```

![](/assets/image/2022-02-16-19-32-45.png)

XOR은 다음과 같은 다층구조의 네트워크이다.

왼쪽부터 0층, 1층, 2층이라 부른다.


AND와 OR은 단층 퍼셉트론이고 XOR는 2층 퍼셉트론이다.

층이 여러개인 퍼셉트론을 다층 퍼셉트론이라 한다.

일반적으로 입력층은 0층으로 계산하여 층의 개수에 포함시키지 않는다. 

따라서 그림에서 층이 총 3개이지만 부를땐 2층퍼셉트론 이라 부른다.


0층의 두 뉴런이 입력신호를 받아 1층의 뉴런으로 신호를 보낸다.

1층의 뉴런이 2층의 뉴런으로 신호를 보내고 2층의 뉴런은 y를 출력한다.


# 2.6 NAND에서 컴퓨터까지


다층 퍼셉트론을 이용하면 복잡한 회로도 구현가능 하다.

2진수->10진수 변환 인코더, 패리티 검사 회로 등. 뿐만 아니라 컴퓨터까지도 구현 가능


# 2.7 정리


- 퍼셉트론은 입출력을 갖춘 알고리즘이다. 입력을 주면 정해진 규칙에 따른 값을 출력한다.

- 퍼셉트론에서는 '가중치'와 '편향'을 매개변수로 설정한다.

- 퍼셉트론으로 AND, OR 게이트 등의 논리 회로를 표현할 수 있다.

- XOR 게이트는 단층 퍼셉트론으로는 표현할 수 없다.

- 2층 퍼셉트론을 이용하면 XOR 게이트를 표현할 수 있다.

- 단층 퍼셉트론은 직선형 영역만 표현할 수 있고, 다층 퍼셉트론은 비선형 영역도 표현할 수 있다.

- 다층 퍼셉트론은 이론상 컴퓨터를 표현할 수 있다.

